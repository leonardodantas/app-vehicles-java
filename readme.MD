# Vehicle API

API RESTful para gerenciamento de ve√≠culos com Spring Boot e MongoDB, incluindo endpoints para cria√ß√£o, atualiza√ß√£o, listagem, dele√ß√£o e filtros avan√ßados.

---

## üîß Stack

- Java 17+
- Spring Boot
- MongoDB
- Swagger/OpenAPI 3
- Docker (MongoDB e Mongo Express)

---

## üìò Estrutura dos Endpoints

### üìå Base URL

```
/v1/vehicles
```

---

### ‚úÖ Criar um ve√≠culo

**POST /v1/vehicles**

Cria um novo ve√≠culo.

#### Request Body (`VehicleRequest`):

```json
{
  "mark": "Ford",
  "year": 2000,
  "model": "Fiesta",
  "description": "Compacto, econ√¥mico e com ar-condicionado",
  "sold": false
}
```

#### Response 201:

`VehicleResponse`

---

### üîç Buscar ve√≠culos (com filtros)

**GET /v1/vehicles**

#### Par√¢metros:

- `available`: (opcional) `s` ou `n`
- `decade`: (opcional) d√©cada do ve√≠culo, ex: 1990
- `mark`: (opcional) marca do ve√≠culo
- `page`: default `0`
- `size`: default `20`

#### Response 200:

Lista paginada de `VehicleResponse`

---

### üïí Buscar ve√≠culos da √∫ltima semana

**GET /v1/vehicles/last-week**

Retorna ve√≠culos cadastrados nos √∫ltimos 7 dias.

#### Par√¢metros:

- `page`: default `0`
- `size`: default `20`

---

### ‚úèÔ∏è Atualizar um ve√≠culo completamente

**PUT /v1/vehicles/{id}**

Substitui todos os dados do ve√≠culo com o `id` especificado.

#### Request Body: `VehicleRequest`

#### Response: `VehicleResponse`

---

### ü©π Atualizar parcialmente (descri√ß√£o e vendido)

**PATCH /v1/vehicles/{id}**

Atualiza apenas a descri√ß√£o e o status de venda do ve√≠culo.

#### Request Body: `VehicleUpdateRequest`

```json
{
  "description": "Novo texto",
  "sold": true
}
```

---

### üóëÔ∏è Deletar ve√≠culo

**DELETE /v1/vehicles/{id}**

Deleta o ve√≠culo com o ID informado.

#### Response 200:

Sem corpo de resposta.

---

## üì§ Exemplo de `VehicleResponse`

```json
{
  "id": "661f7e9be91cc909bfe9db7c",
  "mark": "Ford",
  "year": 2000,
  "model": "Fiesta",
  "description": "Compacto, econ√¥mico e com ar-condicionado",
  "sold": "false"
}
```

---

## ‚ùó Tratamento de Erros

### `ErrorResponse`

```json
{
  "timestamp": "2025-04-29T21:58:00",
  "status": 400,
  "message": "Campo 'mark' √© obrigat√≥rio",
  "path": "/v1/vehicles"
}
```

---

## üß™ Swagger UI

Acesse via:

```
http://localhost:8080/swagger-ui.html
```

---

## üê≥ Docker MongoDB

Exemplo no `docker-compose.yml`:

```yaml
services:
  mongo:
    image: mongo:4.4
    ports:
      - 27017:27017
    environment:
      - MONGO_INITDB_ROOT_USERNAME=leonardo
      - MONGO_INITDB_ROOT_PASSWORD=123456
  mongo-express:
    image: mongo-express
    ports:
      - "8081:8081"
    environment:
      ME_CONFIG_MONGODB_ADMINUSERNAME: leonardo
      ME_CONFIG_MONGODB_ADMINPASSWORD: 123456
      ME_CONFIG_MONGODB_SERVER: mongo
```

---

## üì¶ MongoDB URI

Exemplo:

```yaml
spring:
  data:
    mongodb:
      uri: mongodb://leonardo:123456@localhost:27017/vehicles?authSource=admin
```

---

## üì¨ Testes via Postman

### üì• Importa√ß√£o

- Clique em `Import` no Postman.
- Escolha o tipo `Raw text` e cole um dos exemplos abaixo.
- Altere a URL base conforme seu ambiente (`localhost:8080`).

### Criar um ve√≠culo

```
POST http://localhost:8080/v1/vehicles
Content-Type: application/json

{
  "mark": "Ford",
  "year": 2000,
  "model": "Fiesta",
  "description": "Compacto, econ√¥mico",
  "sold": false
}
```

### Buscar ve√≠culos com filtro por d√©cada e marca

```
GET http://localhost:8080/v1/vehicles?decade=1990&mark=Ford&page=0&size=10
```

### Buscar ve√≠culos da √∫ltima semana

```
GET http://localhost:8080/v1/vehicles/last-week?page=0&size=10
```

### Atualizar um ve√≠culo

```
PUT http://localhost:8080/v1/vehicles/{id}
Content-Type: application/json

{
  "mark": "Fiat",
  "year": 2010,
  "model": "Palio",
  "description": "Compacto atualizado",
  "sold": true
}
```

### Atualiza√ß√£o parcial

```
PATCH http://localhost:8080/v1/vehicles/{id}
Content-Type: application/json

{
  "description": "Novo texto",
  "sold": false
}
```

### Deletar ve√≠culo

```
DELETE http://localhost:8080/v1/vehicles/{id}
```

---


